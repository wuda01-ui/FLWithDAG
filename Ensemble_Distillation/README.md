python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=1;python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=2;python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=3;python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=5;python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=10;python OURSzhenshi.py --dataset=cifar10 --beta=0.3 --attention=0 --device 0 --data_num=20


python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=1;python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=2;python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=3;python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=5;python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=10;python OURSzhenshi.py --dataset=cifar10 --beta=0.1 --attention=0 --device 1 --data_num=20

##############

python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=1;python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=2;python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=3;python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=5;python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=10;python OURSzhenshi.py --dataset=cifar10 --beta=0.5 --attention=0 --device 1 --data_num=20

#############






python OURS.py  --dataset=cifar10 --beta=0.3 --attention=1 --ce=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3 --attention=1 --adv=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3 --attention=1 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3 --attention=0 --ce=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3 --attention=0 --adv=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3 --attention=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.3  --ensem=0 --device 1;python OURS.py  --dataset=cifar10 --beta=0.3  --mh=0 --device 1;



python OURS.py  --dataset=cifar10 --beta=0.5 --attention=1 --ce=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.5 --attention=1 --adv=0 --device 2;python OURS.py  --dataset=cifar10 --beta=0.5 --attention=1 --device 1;python OURS.py  --dataset=cifar10 --beta=0.5 --attention=0 --ce=0 --device 1;python OURS.py  --dataset=cifar10 --beta=0.5 --attention=0 --adv=0 --device 1;python OURS.py  --dataset=cifar10 --beta=0.5 --attention=0 --device 1;python OURS.py  --dataset=cifar10 --beta=0.5  --ensem=0 --device 1;python OURS.py  --dataset=cifar10 --beta=0.5  --mh=0 --device 1;


python OURS.py  --dataset=cifar10 --beta=0.1 --attention=1 --ce=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1 --attention=1 --adv=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1 --attention=1 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1 --attention=0 --ce=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1 --attention=0 --adv=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1 --attention=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1  --ensem=0 --device 0;python OURS.py  --dataset=cifar10 --beta=0.1  --mh=0 --device 0;

python OURS.py  --dataset=svhn --beta=0.1 --attention=1 --ce=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1 --attention=1 --adv=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1 --attention=1 --device 1;python OURS.py  --dataset=svhn --beta=0.1 --attention=0 --ce=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1 --attention=0 --adv=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1 --attention=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1  --ensem=0 --device 1;python OURS.py  --dataset=svhn --beta=0.1  --mh=0 --device 1;

python OURS.py  --dataset=svhn --beta=0.3 --attention=1 --ce=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3 --attention=1 --adv=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3 --attention=1 --device 1;python OURS.py  --dataset=svhn --beta=0.3 --attention=0 --ce=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3 --attention=0 --adv=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3 --attention=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3  --ensem=0 --device 1;python OURS.py  --dataset=svhn --beta=0.3  --mh=0 --device 1;

python OURS.py  --dataset=svhn --beta=0.5 --attention=1 --ce=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5 --attention=1 --adv=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5 --attention=1 --device 2;python OURS.py  --dataset=svhn --beta=0.5 --attention=0 --ce=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5 --attention=0 --adv=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5 --attention=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5  --ensem=0 --device 2;python OURS.py  --dataset=svhn --beta=0.5  --mh=0 --device 2;



## Requirements
- This codebase is written for python3 (used python 3.6 while implementing).
- We use Pytorch version of 1.8.2, 11.4 CUDA version.
- To install necessary python packages,

`pip install -r requirements.txt`

- The logs are uploaded to the wandb server. If you do not have a wandb account, just install and use as offline mode.
python OURSWO.py  --dataset=cifar10 --beta=0.3 --device 1
pip install wandb
wandb off
```
python DENSE.py  --dataset=cifar10 --beta=0.1 --device 0;
python DENSE.py  --dataset=cifar10 --beta=0.3 --device 2; 
python DENSE.py  --dataset=cifar10 --beta=1.0 --device 3;
## How to Run Codes?

### Local Training 
At first, we divide the data into $m$ clients, train the model on each client until it converges and send it to the central server. The sample code is as follows:
```shell
python3 train.py  --dataset=cifar100   --beta=0.1 --device 2
python3 train.py  --dataset=cifar10   --beta=0.3 --device 3
python3 train.py  --dataset=svhn   --beta=0.3 --device 1
python3 train.py  --dataset=svhn   --beta=0.5 --device 1
python3 train.py  --dataset=cifar100   --beta=1 --device 2

python DENSE.py  --dataset=cifar10 --beta=0.1 --device 0;  python DENSE.py  --dataset=cifar10 --beta=0.3 --device 0; python DENSE.py  --dataset=cifar10 --beta=0.5 --device 0; python DENSE.py  --dataset=cifar10 --beta=1.0 --device 0;python DENSE.py  --dataset=cifar10 --beta=100.0 --device 0

python DENSE.py  --dataset=cifar100 --beta=0.1 --device 1;  python DENSE.py  --dataset=cifar100 --beta=0.3 --device 1; python DENSE.py  --dataset=cifar100 --beta=0.5 --device 1; python DENSE.py  --dataset=cifar100 --beta=1.0 --device 1;python DENSE.py  --dataset=cifar100 --beta=100.0 --device 1

python OURS.py  --dataset=cifar10 --beta=1 --device 2;  python OURS.py  --dataset=cifar10 --beta=0.3 --device 2; python OURS.py  --dataset=cifar10 --beta=0.5 --device 0; python OURS.py  --dataset=cifar10 --beta=1.0 --device 2;python OURS.py  --dataset=cifar10 --beta=100.0 --device 2

python OURS.py  --dataset=cifar100 --beta=0.1 --device 3;  python OURS.py  --dataset=cifar100 --beta=0.3 --device 3; python OURS.py  --dataset=cifar100 --beta=0.5 --device 3; python OURS.py  --dataset=cifar100 --beta=1.0 --device 3;python OURS.py  --dataset=cifar100 --beta=100.0 --device 3

python OURS.py  --dataset=cifar10 --beta=1;  python OURS.py  --dataset=cifar10 --beta=0.3;  python OURS.py  --dataset=cifar10 --beta=0.5;  python OURSWO.py  --dataset=cifar10 --beta=1;  python OURSWO.py  --dataset=cifar10 --beta=0.3;  python OURSWO.py  --dataset=cifar10 --beta=0.5;  python DENSE.py  --dataset=cifar10 --beta=1;  python DENSE.py  --dataset=cifar10 --beta=0.3;  python DENSE.py  --dataset=cifar10 --beta=0.5;  

 python DENSE.py  --dataset=cifar10 --beta=0.3 --device 3; python DENSE.py  --dataset=cifar10 --beta=0.5 --device 3; python DENSE.py  --dataset=cifar10 --beta=1.0 --device 3
